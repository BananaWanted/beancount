#!/usr/bin/env python3
"""
Print a list of all the accounts and some associated information.
"""
from os import path
import pprint

from beancount2 import parser
from beancount2 import data
from beancount2 import utils


def main():
    import argparse
    optparser = argparse.ArgumentParser(__doc__.strip())
    optparser.add_argument('filename', help='Filename.')
    opts = optparser.parse_args()

    contents = parser.parse(opts.filename)

    with utils.print_time('open/close'):
        extents = data.get_account_open_close(contents.entries, contents.accounts)

    maxlen = max(map(len, (account.name for account in contents.accounts)))
    for account in contents.accounts:
        open, close = extents[account]
        open_date = open.date if open else ''
        close_date = close.date if close else ''
        print('{:{len}}  {}  {}'.format(account.name, open_date, close_date, len=maxlen))


if __name__ == '__main__':
    main()
